# webGL程序的基本结构
WebGL实际上是一个2D API，并非 3D API.
WebGL只在意两件事情：
1. 坐标: 顶点着色器(vertex shader)提供了空间坐标
2. 颜色: 片元着色器(fragment shader)提供了颜色
坐标值的取值范围永远都是从 -1 到 +1, 而不关心canvas的实际尺寸.

以下是一个基本的WebGl程序结构:
```JS
var canvas = document.getElementById('xxx')
var gl = canvas.getContext('webgl')

// 1. 建立着色器程序
var vertexShader = `
attribute vec2 a_position;

void main () {
    gl_Position = vec4(a_position, 0, 1);
}
`
var fragmentShader = `
void main () {
    gl_FragColor = vec4(0, 1, 0, 1);    // 绿色 
}
`
var program = createProgram(gl, [vertexShader, fragmentShader])
gl.useProgram(program)

// 获取顶点着色器的位置
var positionLocation = gl.getAttribLocation(program, 'a_position')
// 创建一个buffer, 并且放置两个三角形进去.
var buffer = gl.createBuffer()
gl.bindBuffer(gl.ARRAY_BUFFER, buffer)
gl.bufferData(
    gl.ARRAY_BUFFER,
    new Float32Array([
        -1.0, -1.0,
         1.0, -1.0,
        -1.0,  1.0,
        -1.0,  1.0,
         1.0, -1.0,
         1.0,  1.0
    ]),
    gl.STATIC_DRAW
)
gl.enableVertexAttribArray(positionLocation)
gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0)

// 绘制
gl.drawArrays(gl.TRIANGLES, 0, 6)

```

# 着色器
着色器是使用 OpenGL ES Shading Language(GLSL)编写的程序，它携带着绘制形状的顶点信息以及构造绘制在屏幕上像素的所需数据，换句话说，它负责记录着像素点的位置和颜色。

绘制WebGL时候有两种不同的着色器函数，顶点着色器和片段着色器。你需要通过用GLSL 编写这些着色器，并将代码文本传递给WebGL ， 使之在GPU执行时编译。顶点着色器和片段着色器的集合我们通常称之为着色器程序

## 1. 顶点着色器
每次渲染一个形状时，顶点着色器会在形状中的每个顶点运行。 它的工作是将输入顶点从原始坐标系转换到WebGL使用的缩放空间(clipspace)坐标系，其中每个轴的坐标范围从-1.0到1.0，并且不考虑纵横比，实际尺寸或任何其他因素。

顶点着色器需要对顶点坐标进行必要的转换，在每个顶点基础上进行其他调整或计算，然后通过将其保存在由GLSL提供的特殊变量（我们称为gl_Position）中来返回变换后的顶点

顶点着色器根据需要， 也可以完成其他工作。例如，决定哪个包含 texel面部纹理的坐标，可以应用于顶点；通过法线来确定应用到顶点的光照因子等。然后将这些信息存储在变量（varyings)或属性(attributes)属性中，以便与片段着色器共享

以下的顶点着色器接收一个我们定义的属性（aVertexPosition）的顶点位置值。这个位置值是两个4x4矩阵uProjectionMatrix和uModelMatrix的乘积; gl_Position为结果值。
```js
// Vertex shader program

  const vsSource = `
    attribute vec4 aVertexPosition;

    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;

    void main() {
      gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
    }
    
  `;
```


## 2. 片元着色器
片段着色器在顶点着色器处理完图形的顶点后，会被要绘制的每个图形的每个像素点调用一次。它的职责是确定像素的颜色，通过指定应用到像素的纹理元素（也就是图形纹理中的像素），获取纹理元素的颜色，然后将应用适当的光照。之后颜色存储在特殊变量gl_FragColor中，返回到WebGL层。该颜色将最终绘制到屏幕上图形对应像素的对应位置
```js
const fsSource = `
    void main() {
      gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
    }
  `;
```



