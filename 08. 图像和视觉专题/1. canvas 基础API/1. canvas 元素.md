
# canvas 
1. canvas 元素属于替换元素, 必须是以` <canvas></canvas> `(不同于`<img/>`) 形式处理，(虽然在React中会处理)。
2. 如果不设置宽度/高度，则默认宽度 300， 高度 150.
3. width/height 和 style 中的 width 和 height 的区别： 
* 属性width/height 表示像素。
* style 中的 width/height 只表示显示视窗。 style 只会影响视觉，不会影响画布内容。


# rendering context: HTMLCanvasElement.getContext( contextType, contextAttributes)
在同一个 canvas 上多次调用此方法（类型相同），返回的是同一个的 context。  
？推论：
1. 可以认为一个 canvas 只存在固定的几种 context。
2. 第一次使用的 getContext 是创建 context, 以后调用的相同类型的 context 只是引用。 
  

## contextType:
1. 2d: 
2. webgl: 
3. webgl2: (实验中)
4. bitmaprenderer: (实验中)

### 2d 的 contextAttributes
alpha: 表示画布是否包含透明度通道。

### webgl 的 contextAttributes
* alpha
* antialiase
* depth: boolean, 表明绘制缓冲区包含一个深度至少为 16 位的缓冲区。  
* stencil: boolean, 表明绘制缓冲区包含一个深度至少为 8 位的模板缓冲区。  
* preserveDrawingBuffer: 如果这个值为 true，缓冲区将不会被清楚，会保存下来，直到被清除或被使用者覆盖。
注意：在绘制完成后的 event loop 中，应该立即导出画布内容，否则导出的内容为空。
* premulipliedAlpha: boolean, 表明排版引擎将假设绘制缓冲区包含预混合 alpha 通道。   
颜色rgb已经预乘以 alpha 值。
* failIfMajorPerformanceCaveat: boolean, 表明在一个系统性能低的环境是否创建该上下文。  
* powerPreference: 指示浏览器在运行 webgl context 时使用相应的 GPU 电源配置。可能值如下：
  * default: 自动选择, 默认值
  * high-performance: 高性能模式
  * low-power: 节能模式


## ？问题
1. 是否必须确定了 canvas 的 width 和 height 以后，才能获取 context
2. canvas 的 width 和 height 发生变化后，之前 context 是否还有效  
3. 已验证: 第一次 getContext 是创建，第二次是 获取，尽管方法传入不同 contextAttributes.  
4. 已验证：任何对 canvas 的 width 和 height 的写操作会导致 canvas 清空，即使值不会发生变化。  
```js
var ctx = canvas.getContext('2d', { alpha: true});
var ctx2 = canvas.getContext('2d', { alpha: false});
ctx === ctx2;       // true
drawFace(ctx2);     // 整个画图还是透明的
```



## 获取结果 toDataURL, toBlob  


https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Drawing_shapes

