190 - 207 - 213 颜色和纹理
247 - 501 

7. 进入三维世界
8. 光照
9. 层次模型
10. 高级技术


# 图形到片元的转化，图元光栅化(rasterzation process)
基本过程：顶点坐标（其他信息） -> 图形装配 -> 光栅化 -> 执行片元着色器。
片元数目就是图形最终在屏幕上所覆盖的像素数。
一旦光栅化过程结束，程序就开始逐个片元调用片元着色器，每调用一次，就处理一个片元。
```js
const FRAGMENT_SHADER_SOURCE = `
precision mediump float;
uniform float u_Width;
uniform float u_Height;

void main() {
  gl_FragColor = vec4(gl_FragCoord.x / u_Width, 0.0, gl_FragCoord.y / u_Height, 1.0);
}
`;
```

# 将图像(或纹理)映射到图形或三维对象的表面上
在 webgl，进行纹理映射，需遵循4个步骤：
1. 准备好映射到几何图形上的纹理图像
2. 为几何图形配置纹理映射方式, （纹理图像多为异步加载）
3. 加载纹理图像，对其进行一些配置，以及在 webgl 中使用它  
4. 在片元着色器中将相应的纹素(texel)从纹理中抽取出来，并将纹素的颜色赋给片元  
## 纹理坐标
纹理坐标是纹理图像上的坐标，纹理坐标是二维的，为了区分xy，使用 st 命名。
左下角(0.0, 0.0), 右下角(1.0, 0.0), 右上角(1.0, 1.0), 左上角(0.0, 1.0).  
```js
const VERTEX_SHADER_SOURCE = `
attribute vec4 a_Position;
attribute vec2 a_TexCoord;
varing vec2 v_TexCoord;

void main() {
  gl_Position = a_Position;
  v_TexCoord = a_TexCoord;
}
`;
const FRAGMENT_SHADER_SOURCE = `
uniform sampler2D u_Sampler;
varing vec2 v_TexCoord;

void main() {
  gl_FragColor = texture2D(u_Sampler, v_TexCoord);
}
`;

const verticesTexCoords = new Float32Array([
  // 顶点坐标，   纹理坐标    注意： gl.TRIANGLE_STRIP 的四个点顺序
  -0.5, 0.5,    0.0, 1.0,
  -0.5, -0.5,   0.0, 0.0,
  0.5, 0.5,     1.0, 1.0,
  0.5, -0.5,    1.0, 0.0,
]);
const vertexTexCoordBuffer = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, vertexTexCoordBuffer);
gl.bufferData(gl.ARRAY_BUFFER, verticesTexCoords, gl.STATIC_DRAW);
const FSIZE = verticesTexCoords.BYTES_PER_ELEMENT;
const a_Position = gl.getAttribLocation(gl.program, 'a_Position');
gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, FSIZE * 4, 0);
gl.enableVertexAttribArray(a_Position);
const a_TexCoord = gl.getAttribLocation(gl.program, 'a_TexCoord');
gl.vertexAttribPointer(a_TexCoord, 2, gl.FLOAT, false, FSIZE * 4, FSIZE * 2);
gl.enableVertexAttribArray(a_TexCoord);

const texture = gl.createTexture();
const u_Sampler = gl.getUniformLocation(gl.program, 'u_Sampler');
const image = new Image();
image.src = '';
image.onload = function() { loadTexture(gl, n, texture, u_Sampler, image);}

function loadTexture(gl, n, texture, u_Sampler, image) {
  gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);    // 对纹理图像进行Y轴反转
  gl.activeTexture(gl.TEXTURE0);                // 开启0号纹理单元
  gl.bindTexture(gl.TEXTURE_2D, texture);       // 向 target 绑定纹理对象

  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);  // 配置纹理参数
  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image); // 配置纹理图像

  gl.uniformli(u_Sampler, 0);

  gl.drawArrays(gl.TRIANGLE_STRIP, 0, n);     // 绘制矩形
}

```



