# IPC (inter-process communication)
在主进程中引用： const ipc = require('electron').ipcMain;   
在渲染进程中引用： const ipc = require('electron').ipcRenderer;  

1. 同步消息
ipc.sendSync(channel, [, arg1] [, arg2] [...])
channel: 字符串，表示消息的名称，可以自定义。  
其他的参数表示发送消息时的数据部分，可以为对象类型。
```js
// 发送消息部分
const reply = ipc.sendSync('sync-msg', 'hello');

// 接收消息的部分
ipc.on('sync-msg', function(event, arg) {
  // 同步消息的回复
  event.returnValue = 'World';
})

```

2. 异步消息 
ipc.send(channel, [, arg1] [, arg2] [...])  
收到消息后的回复是通过event对象来完成： event.sender.send(channel, ...)
```js
ipc.on('async-msg', function(event, arg) {
  event.sender.send('xxx', 'data');
})
```

3. ipc事件管理
```js
ipc.once(channelName, functionXXX);

ipc.removeListener(channelName, functionXXX);

ipc.removeAllListeners(channelName);
```

# native对话框模块
在主进程中： const { dialog } = require('electron');   
在渲染进程中： const { dialog } = require('electron').remote;  

## 1. dialog.showOpenDialog(browserWindow, options, callback)
第一个参数存在，即表示模态对话框。 
第二个参数表示对话框的配置属性。  
例子：
```js
{
  title: 'Select File',
  properties: ['openFile', 'openDirectory'],
  filters: [
    {
      name: 'Plain Text', 
      extensions: [
        'txt', 
        'css', 
        'html', 
        'js', 
        'vue', 
        'json', 
        'py', 
        'c'
      ]
    }
  ]
}
```
### properties 属性有如下选项：    
1. openFile: 允许选中文件  
2. openDirectory: 允许选中文件夹  
3. multiSelections: 允许多个选中  
4. showHiddenFiles: 显示正常隐藏的系统文件。  
5. createDirectory: (MacOS Only)在对话框上会新增一个 New Folder 按钮。
6. promptToCreate: (windows Only) 弹出一个用户创建文件夹的确认框   
### filter 属性： （扩展名前面不需要加点）
### 其他属性： title（在Mac上会被忽略），defaultPath， buttonLabel(确定按钮的名称，默认是 Open)

## 2. dialog.showSaveDialog
它的options有四个属性：title，defaultPath，buttonLabel， filters。  
基本设置都同上，但有一点细微区别： 
1. 如果defaultPath填写的是文件夹路径，则默认文件名是 untitled。可以把文件名也写进 defaultPath.
2. 如果没有在defaultPath上写进完整的文件名，则会默认使用上一次filter的后缀。
```js
dialog.showSaveDialog(
  win,
  {
    title: 'save',
    buttonLabel: 'save',
    defaultPath: __dirname + 'abc.txt',
    filters: [{ name: "Text", extensions: ['txt']}]
  },
  function(file) {
    let data = 'test';
    fs.writeFile(file, data, function(err) {
      ...
    })
  }
)
```

## 3. dialog.showMessageBox
messageBox 的类型： 'info'， 'error', 'question', 'none'.  
defaultId 属性：确定 buttons 数组中哪个按钮是主按钮。  
canceled 属性；只有在windows下可以使用，如果buttons数组中没有‘Cancel’或‘No’。  
其他属性： title, message, detail， 显示dialog上的文本。  
```js
dialog.showMessageBox({
  type: 'info',
  buttons: ['Save', 'Cancel', 'Don\'t Save'],
  defaultId: 0,
  title: 'Save Score',
  message: 'Backup your score file?',
  detail: 'Message Detail'
}, function (index) {
  // index 表示是哪个button被点击
  console.log(index);
})
```
在dialog上显示定制的ICON：
```js
const { nativeImage } = require('electron');
let warningIcon = nativeImage.createFromPath('user/xxx.png');
dialog.showMessageBox({
  ...,
  icon: warningIcon,
})

```

## 4. dialog.showErrorBox(title: string, content: string)
不支持定制Icon。 


# nodejs的fs模块 
## fs.open(path, flags [, mode], callback)
flags: 控制文件的交互。  
mode： 控制文件的权限。  
flags 的可选值：
1. r: 只读
2. r+： 可读可写
3. rs：可读，同步模式
4. rs+：可读可写，同步模式
5. w：可写，如果文件不存在，则创建一个文件，如果文件存在，则overwrite
6. wx：可写，如果文件不存在，则失败
7. w+： 可读可写，如果文件不存在，则创建一个文件，如果文件存在，则overwrite
8. a：追加，如果文件不存在，则创建一个文件
9. a+：可读可追加，如果文件不存在，则创建一个文件
10. ax：追加，如果文件不存在，则失败
11. ax+：可读可追加，如果文件不存在，则失败

## fs.stat(filepath, callback) 读取文件信息
```js
fs.stat(filepath, function(err, stats) {
  if (err) {
    return;
  }
  stats.isFile();
  stats.isDirectory();
})
```
## fs.writeFile(file, data[, options], callback)
## fs.readFile(file, 'utf-8', function(err,data))
## fs.existsSync, fs.unlink
```js
if (fs.existsSync(filepath)) {
  fs.unlink(filepath, function(err) {
    ...
  })
}
```

## fs.watch
```js
fs.watch(filename, { persistent: true }, function(event, filename){
  console.log(event + " event occurred on " + filename);
})
```
## fs.mkdir, fs.readdir, fs.rmdir
```js
fs.mkdir(myDir, function(err){
  if (err) {
    console.log(err);
  }
  ...
})

fs.readdir(path, function(err, files) {
  ...
})

fs.rmdir(path, function(err) {
  ...
})

```
