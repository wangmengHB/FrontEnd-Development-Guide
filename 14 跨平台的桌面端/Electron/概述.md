# Electron
在Electron之前，有一个跨平台桌面端框架 NW.js (node-webkit).(和Electron的作者是同一人)
NW.js 支持winXP，Electron支持win7以及以上。Electron的设计架构更先进。

Electron 是由三部分组成：Chromium，nodejs，操作系统兼容部分。
操作系统兼容这部分的工作是Electron内部解决的，对于开发者来说并不需要关心。开发者需要关注的只有两部分：Chromium 和 nodejs。

## Chromium
Chromium有很多开源的版本，不同的版本之间会有一些差异，Electron使用的是Chromium Content Module. 它是浏览器的核心部分，包含Blink渲染引擎，自己的V8引擎（非nodjes部分的v8引擎）。
CCM 只关于核心需求：渲染网页。对于其他的浏览器特性：Chrome扩展插件，同步Chrome书签等，它是不支持的。


## Electron 的优点：
1. 和native的程序一样：
对话框和右键菜单可以是native的，支持文件拖拽。文件名后缀关联启动。支持系统通知。
2. 相对于浏览器的安全限制，Electron的运行环境更宽松。
3. 离线优先设计

## Electron 如何工作：
1. 两个进程：主进程和渲染进程
只有主进程可以访问本地系统资源，它是nodejs环境。（包含native对话框，native菜单等）
系统的剪切板可以被两个进程都访问。
渲染进程是由主进程启动。
不同于传统的web应用，渲染进程也可以访问已安装的node modules。
2. 主进程 app instance 的事件：
ready:  
window-all-closed:  Mac OS （platform: darwin）可以关闭所有的窗体但不退出应用。
activate: 
3. 渲染进程： 在渲染进程的html环境中是可以访问nodejs环境，比如 process API. 


## BrowserWindow 基础
1. ready-to-show event: 
```js
const win = new BrowserWindow({show: fasle});
win.once('ready-to-show', () => win.show()); 
```
2. BrowserWindow 构造函数的默认配置：
```js
{
  show: true,
  backgroundColor: '#FFF', // 不能是rgb（）或者rgba（）格式，只支持这一种格式
  width: 800,
  height: 600,
  minWidth: 0,
  minHeight: 0,
  maxWidth: UNLIMITED,
  maxHeight: UNLIMITED,
  resizable: true,
  movable: true,
  alwaysOnTop: false,
  frame: true, // 如果设置为false，则窗体没有边框，没有关闭/最大化等按钮
  // 在macOS下，不使用frame属性，而是使用 'hidden' 或 'hidden-inset'
  // 可以让关闭/最大化按钮显示，而不显示标题栏.
  // 在windows系统上，titleBarStyle 属性无效
  titleBarStyle: 'default',
  transparent: false, 
  // 如果需要设置为 true，则需要去掉 backgroundColor 属性
  // 可以在html中设置背景色半透明
  
}
```
当窗体创建后，还可以通过以下方法修改：setBounds(bounds), setSize(width, height), setMinimumSize(width, height), setMaximumSize(width, height).
如果设置了x,y属性，则center会自动置为
title属性：当html中的title为空时，这时title属性才会生效。
对于frameless window，只能通过css方法解决，比如：
```html
<body style="-webkit-app-region: drag">
```
但是这样的缺陷是，整个页面的事件都被拦截，正确的做法是在某个元素上加上这个。
当然，movable: false 的优先级是最高的。

## 本地菜单和 contextual menu





107/371

5. custom menus: 105
keyboard shortcuts and menu item roles
checkmarks
contextual menu
6. IPC module 132
sync/async messaging
managing event listener
7. dialog module
file open/save dialog
message/error dialog
8. WebContents, Screens, Locales: 179
9. Dock Icon on MacOS: 219
10. Shell: 232
11. Online/Offline detect
12. Advanced BrowserWindow
13. Debugging
14. Testing with Spectron
15. Building App
16. Auto Updating
17. Other








